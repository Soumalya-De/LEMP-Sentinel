# CVE Remediation Playbook

## Overview

Operational procedures for handling CVEs discovered in LEMP-Sentinel.

**Purpose:** Step-by-step response guide  
**Related:** [CVE Remediation Strategy](cve-remediation.md) for context and prevention

**Last Updated:** November 10, 2025

---

## Detection (Automated)

### Vulnerability Scanning

**Primary Tool:** Trivy (Aqua Security)  
**Schedule:** Every Monday at 9:00 AM UTC  
**Workflow:** `.github/workflows/cve-remediation-monitor.yml`

**What gets scanned:**
- Docker base images (PHP, Nginx, MySQL, Alpine)
- Application dependencies (PHP packages via Composer)
- System packages (Alpine Linux apk)

**Automated Actions:**
1. Trivy scans all Docker images
2. New CVEs trigger GitHub issue creation
3. Issues are labeled by severity (CRITICAL, HIGH, MEDIUM, LOW)
4. Issue includes:
   - CVE ID and CVSS score
   - Affected package and version
   - Remediation SLA deadline
   - Link to upstream fix tracker

---

## Triage Process

### Severity Definitions

| Severity | CVSS Score | SLA | Priority |
|----------|------------|-----|----------|
| CRITICAL | 9.0 - 10.0 | 7 days | P0 - Drop everything |
| HIGH | 7.0 - 8.9 | 14 days | P1 - Urgent |
| MEDIUM | 4.0 - 6.9 | 30 days | P2 - Scheduled |
| LOW | 0.1 - 3.9 | 60 days | P3 - Backlog |

### CRITICAL Severity (7-Day SLA)

**Timeline:** Fix within 7 days

**Steps:**
1. Confirm CVE applicability
2. Check for upstream fix
3. Test patch in dev
4. Apply fix and rescan
5. Deploy

**Options:**
- Immediate patch if available
- Workaround (disable feature, network restrictions)
- Document accepted risk if exploitation unlikely

---

### HIGH Severity (14-Day SLA)

**Timeline:** Fix within 14 days

**Steps:**
1. Test patch in dev/staging
2. Verify no breaking changes
3. Deploy and monitor

### MEDIUM Severity (30-Day SLA)

**Timeline:** Fix within 30 days

**Approach:** Bundle multiple fixes together, coordinate with dependency updates

### LOW Severity (60-Day SLA)

**Timeline:** Fix within 60 days

**Approach:** Include in next scheduled maintenance

---



## Remediation Workflow

```bash
# 1. Create fix branch
git checkout -b fix/cve-2025-xxxxx

# 2. Update affected component (e.g., base image)
# Edit Dockerfiles as needed

# 3. Rebuild and test
docker compose build --no-cache
docker compose up -d

# 4. Run security scan
trivy image lemp-sentinel-php:latest

# 5. Create PR if clean
git add .
git commit -m "security: fix CVE-2025-xxxxx"
git push origin fix/cve-2025-xxxxx
```

---

## Post-Remediation

1. Rescan with Trivy to confirm fix
2. Remove from `.trivyignore`
3. Close GitHub issue
4. Update release notes

---

## Escalation

Escalate if:
- CVE is actively exploited
- No fix available within SLA
- Fix requires major changes

Contact: [GitHub Security Advisories](https://github.com/Soumalya-De/LEMP-Sentinel/security/advisories)

---

## Special Scenarios

### No Fix Available
- Implement workaround (network restriction, WAF rule)
- Document accepted risk in `.trivyignore`
- Review weekly for upstream fix

### False Positive
- Verify CVE doesn't apply
- Add to `.trivyignore` with explanation
- Review quarterly

### Breaking Changes
- CRITICAL/HIGH: Fix app code or workaround
- MEDIUM/LOW: Defer to next major version

---

## References

- [CVE Remediation Strategy](./cve-remediation.md)
- [Security Hardening Guide](./security-hardening.md)
- [Trivy Documentation](https://aquasecurity.github.io/trivy/)
- [Alpine Linux Security](https://security.alpinelinux.org/)
